<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ultimate Calculator</title>

<style>
*{box-sizing:border-box;font-family:system-ui}
body{
  background:#0b1220;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  margin:0;
}
.calc{
  width:340px;
  background:#111a2e;
  border-radius:24px;
  padding:16px;
  box-shadow:0 20px 40px rgba(0,0,0,.6);
}
.display{
  height:70px;
  background:#060b18;
  color:#fff;
  border-radius:16px;
  padding:16px;
  font-size:28px;
  text-align:right;
  overflow-x:auto;
}
.keys{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
  margin-top:16px;
}
button{
  height:56px;
  border:none;
  border-radius:50%;
  font-size:20px;
  background:#1c263d;
  color:#fff;
}
button.op{background:#263252}
button.eq{background:#1fbf63;color:#000}
button.clear{background:#e94444}
button:active{transform:scale(.96)}
</style>
</head>

<body>
<div class="calc">
  <div id="display" class="display">0</div>

  <div class="keys">
    <button class="clear" onclick="clearAll()">C</button>
    <button onclick="input('(')">(</button>
    <button onclick="input(')')">)</button>
    <button class="op" onclick="input('/')">÷</button>

    <button onclick="input('7')">7</button>
    <button onclick="input('8')">8</button>
    <button onclick="input('9')">9</button>
    <button class="op" onclick="input('*')">×</button>

    <button onclick="input('4')">4</button>
    <button onclick="input('5')">5</button>
    <button onclick="input('6')">6</button>
    <button class="op" onclick="input('-')">−</button>

    <button onclick="input('1')">1</button>
    <button onclick="input('2')">2</button>
    <button onclick="input('3')">3</button>
    <button class="op" onclick="input('+')">+</button>

    <button onclick="input('0')">0</button>
    <button onclick="input('.')">.</button>
    <button onclick="input('^')">^</button>
    <button class="eq" onclick="calculate()">=</button>
  </div>
</div>

<script>
let expr = "";

const display = document.getElementById("display");

function input(v){
  if(display.innerText==="0") expr="";
  expr += v;
  display.innerText = expr;
}

function clearAll(){
  expr="";
  display.innerText="0";
}

/* ---------- ENGINE ---------- */

// power for BigInt
function bigPow(a,b){
  let r=1n;
  for(let i=0n;i<b;i++) r*=a;
  return r;
}

function calculate(){
  try{
    let safe = expr
      .replace(/(\d+)\^(\d+)/g,'bigPow($1n,$2n)')
      .replace(/(\d+)/g,'$1n');

    let result = eval(safe);
    display.innerText = result.toString();
    expr = result.toString();
  }catch(e){
    display.innerText="ERROR";
    expr="";
  }
}
</script>
</body>
</html>
