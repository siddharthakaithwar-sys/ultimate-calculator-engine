<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ultimate Calculator</title>

<style>
* { box-sizing: border-box; font-family: system-ui, sans-serif; }
body {
  margin: 0;
  background: radial-gradient(circle at top, #0f1c3a, #020617);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
}

.calc {
  width: 360px;
  background: #0b1530;
  border-radius: 26px;
  padding: 18px;
  box-shadow: 0 30px 80px rgba(0,0,0,.6);
}

.display {
  background: #020617;
  border-radius: 18px;
  padding: 18px;
  font-size: 28px;
  text-align: right;
  min-height: 60px;
  overflow-x: auto;
}

.mode {
  text-align: right;
  font-size: 12px;
  opacity: .6;
  margin-bottom: 6px;
}

.grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin-top: 16px;
}

.btn {
  height: 58px;
  border-radius: 50%;
  border: none;
  font-size: 18px;
  background: #1b2a4a;
  color: #fff;
  cursor: pointer;
}
.btn.op { background: #24365f; }
.btn.fn { background: #2e4070; }
.btn.red { background: #ef4444; }
.btn.green {
  background: #22c55e;
  grid-column: span 4;
  border-radius: 30px;
  font-size: 22px;
}

.history {
  margin-top: 12px;
  max-height: 140px;
  overflow-y: auto;
  background: rgba(0,0,0,.25);
  border-radius: 12px;
  padding: 6px;
  font-size: 14px;
}
.history div {
  padding: 4px 6px;
  cursor: pointer;
  opacity: .85;
}
.history div:hover { background: rgba(255,255,255,.08); }
</style>
</head>

<body>
<div class="calc">

<div class="mode" id="mode">RAD</div>
<div class="display" id="display">0</div>

<div class="grid">
<button class="btn red" onclick="clearAll()">C</button>
<button class="btn fn" onclick="toggleMode()">DEG</button>
<button class="btn fn" onclick="insert('(')">(</button>
<button class="btn fn" onclick="insert(')')">)</button>

<button class="btn fn" onclick="func('sin')">sin</button>
<button class="btn fn" onclick="func('cos')">cos</button>
<button class="btn fn" onclick="func('tan')">tan</button>
<button class="btn fn" onclick="insert('/')">÷</button>

<button class="btn" onclick="insert('7')">7</button>
<button class="btn" onclick="insert('8')">8</button>
<button class="btn" onclick="insert('9')">9</button>
<button class="btn op" onclick="insert('*')">×</button>

<button class="btn" onclick="insert('4')">4</button>
<button class="btn" onclick="insert('5')">5</button>
<button class="btn" onclick="insert('6')">6</button>
<button class="btn op" onclick="insert('-')">−</button>

<button class="btn" onclick="insert('1')">1</button>
<button class="btn" onclick="insert('2')">2</button>
<button class="btn" onclick="insert('3')">3</button>
<button class="btn op" onclick="insert('+')">+</button>

<button class="btn" onclick="insert('0')">0</button>
<button class="btn" onclick="insert('.')">.</button>
<button class="btn fn" onclick="backspace()">⌫</button>

<button class="btn green" onclick="calculate()">=</button>
</div>

<div class="history" id="history"></div>

</div>

<script>
let expr = "";
let history = [];
let deg = false;

const display = document.getElementById("display");
const historyBox = document.getElementById("history");
const modeText = document.getElementById("mode");

function update() {
  display.textContent = expr || "0";
}

function insert(v) {
  expr += v;
  update();
}

function func(f) {
  expr += f + "(";
  update();
}

function backspace() {
  expr = expr.slice(0, -1);
  update();
}

function clearAll() {
  expr = "";
  update();
}

function toggleMode() {
  deg = !deg;
  modeText.textContent = deg ? "DEG" : "RAD";
}

function toRad(x) {
  return deg ? x * Math.PI / 180 : x;
}

function calculate() {
  if (!expr) return;

  try {
    let e = expr
      .replace(/sin\(/g, "Math.sin(toRad(")
      .replace(/cos\(/g, "Math.cos(toRad(")
      .replace(/tan\(/g, "Math.tan(toRad(");

    let result = Function("toRad", "return " + e)(toRad);
    result = Number(result.toPrecision(12));

    history.unshift(expr + " = " + result);
    if (history.length > 10) history.pop();

    expr = String(result);
    update();
    renderHistory();

  } catch {
    expr = "Error";
    update();
    expr = "";
  }
}

function renderHistory() {
  historyBox.innerHTML = "";
  history.forEach(h => {
    let d = document.createElement("div");
    d.textContent = h;
    d.onclick = () => {
      expr = h.split("=")[0].trim();
      update();
    };
    historyBox.appendChild(d);
  });
}
</script>
</body>
</html>
